#!/usr/bin/ruby
$:.push '/home/ebrodeur/Projects/bin_snippets/lib'
require 'app'
require 'log'
require 'config'
require 'optparser'
require 'dm'
require 'filemagic'

include ErnieBrodeur
include ErnieBrodeur::NextBackground
App.version = "0.2.0"
App.banner = "This will change backgrounds based on a variety of rules."

r = false
d = false
k = false

Options.on("-a", "--add-directory [DIRECTORY]", "Add a directory to the database.") { |dir| add_directory dir}
Options.on("-f", "--add-file [FILE]", "Add a file to the database.") {|file| add_file file}
Options.on("-r", "--run-once", "Set the output file(s) a single time.") { r = true}
Options.on("-d", "--daemonize", "Split into the background, changing every X interval.") {d = true}
Options.on("-k", "--kill-daemon", "Kill any existing daemon.") {k = true}
Options.parse!
Options.on_pry

if __FILE__ == $0
  run_once if r
  daemonize if d
  kill_daemon if k
end
