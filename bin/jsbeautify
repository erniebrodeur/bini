#!/usr/bin/ruby
$:.push '/home/ebrodeur/Projects/bin_snippets/lib'
require 'yajl'

require 'bini/app'
require 'bini/optparser'

include Bini

App.version = "0.9.0"
App.banner = "Usage: print json into a pretty format, or break trying."

Options.parse!

def process_input(s)
  puts Yajl.dump(Yajl.load(s), {:pretty => true})
end

if __FILE__ == $0
  if ARGV.empty?
    begin
      puts process_input STDIN
    rescue Exception => e
      puts e.message
      exit
    end
  else
    ARGV.each do |f|
      if File.exist? f
        process_input open(f).read
      else
        puts "No such file: #{f}"
      end
    end
  end
end
